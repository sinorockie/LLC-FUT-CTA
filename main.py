import threading
import time

import requests as requests


def call_api(api: str, data: dict):
    for i in range(1000):
        requests.post(api, json=data)


if __name__ == '__main__':
    vanilla = {
        "id": 123,
        "evaluationType": "OneAssetOption",
        "evaluationDate": 44630,
        "oneAssetOptionMaker": {
            "instrumentType": "EuropeanVanillaOptionMaker",
            "type": "Call",
            "strike": 65.0,
            "date": 45000
        },
        "oneAssetOptionEngineMaker": {
            "engineType": "AnalyticEuropeanEngineMaker",
            "dt": 0.0
        },
        "generalizedBlackScholesProcessMaker": {
            "processType": "Type1",
            "x0": 60.0,
            "dividendRate": 0.0,
            "riskFreeRate": 0.08,
            "sigma": 0.3,
            "dayCounter": "Act360"
        }
    }
    autocall = {
        "id": "1234",
        "evaluationType": "Autocall",
        "evaluationDate": 45001,
        "autocallMaker": {
            "instrumentType": "SnowBallOptionMaker",
            "effectiveDate": 44539,
            "maturityDate": 45271,
            "notePastFixings": 13,
            "optionPastFixings": 462,
            "noteFixingDates": [
                44629,
                44662,
                44690,
                44721,
                44753,
                44782,
                44813,
                44844,
                44874,
                44904,
                44935,
                44966,
                44994,
                45026,
                45055,
                45086,
                45117,
                45147,
                45180,
                45208,
                45239,
                45271
            ],
            "optionFixingDates": [
                44539,
                44540,
                44541,
                44542,
                44543,
                44544,
                44545,
                44546,
                44547,
                44548,
                44549,
                44550,
                44551,
                44552,
                44553,
                44554,
                44555,
                44556,
                44557,
                44558,
                44559,
                44560,
                44561,
                44562,
                44563,
                44564,
                44565,
                44566,
                44567,
                44568,
                44569,
                44570,
                44571,
                44572,
                44573,
                44574,
                44575,
                44576,
                44577,
                44578,
                44579,
                44580,
                44581,
                44582,
                44583,
                44584,
                44585,
                44586,
                44587,
                44588,
                44589,
                44590,
                44591,
                44592,
                44593,
                44594,
                44595,
                44596,
                44597,
                44598,
                44599,
                44600,
                44601,
                44602,
                44603,
                44604,
                44605,
                44606,
                44607,
                44608,
                44609,
                44610,
                44611,
                44612,
                44613,
                44614,
                44615,
                44616,
                44617,
                44618,
                44619,
                44620,
                44621,
                44622,
                44623,
                44624,
                44625,
                44626,
                44627,
                44628,
                44629,
                44630,
                44631,
                44632,
                44633,
                44634,
                44635,
                44636,
                44637,
                44638,
                44639,
                44640,
                44641,
                44642,
                44643,
                44644,
                44645,
                44646,
                44647,
                44648,
                44649,
                44650,
                44651,
                44652,
                44653,
                44654,
                44655,
                44656,
                44657,
                44658,
                44659,
                44660,
                44661,
                44662,
                44663,
                44664,
                44665,
                44666,
                44667,
                44668,
                44669,
                44670,
                44671,
                44672,
                44673,
                44674,
                44675,
                44676,
                44677,
                44678,
                44679,
                44680,
                44681,
                44682,
                44683,
                44684,
                44685,
                44686,
                44687,
                44688,
                44689,
                44690,
                44691,
                44692,
                44693,
                44694,
                44695,
                44696,
                44697,
                44698,
                44699,
                44700,
                44701,
                44702,
                44703,
                44704,
                44705,
                44706,
                44707,
                44708,
                44709,
                44710,
                44711,
                44712,
                44713,
                44714,
                44715,
                44716,
                44717,
                44718,
                44719,
                44720,
                44721,
                44722,
                44723,
                44724,
                44725,
                44726,
                44727,
                44728,
                44729,
                44730,
                44731,
                44732,
                44733,
                44734,
                44735,
                44736,
                44737,
                44738,
                44739,
                44740,
                44741,
                44742,
                44743,
                44744,
                44745,
                44746,
                44747,
                44748,
                44749,
                44750,
                44751,
                44752,
                44753,
                44754,
                44755,
                44756,
                44757,
                44758,
                44759,
                44760,
                44761,
                44762,
                44763,
                44764,
                44765,
                44766,
                44767,
                44768,
                44769,
                44770,
                44771,
                44772,
                44773,
                44774,
                44775,
                44776,
                44777,
                44778,
                44779,
                44780,
                44781,
                44782,
                44783,
                44784,
                44785,
                44786,
                44787,
                44788,
                44789,
                44790,
                44791,
                44792,
                44793,
                44794,
                44795,
                44796,
                44797,
                44798,
                44799,
                44800,
                44801,
                44802,
                44803,
                44804,
                44805,
                44806,
                44807,
                44808,
                44809,
                44810,
                44811,
                44812,
                44813,
                44814,
                44815,
                44816,
                44817,
                44818,
                44819,
                44820,
                44821,
                44822,
                44823,
                44824,
                44825,
                44826,
                44827,
                44828,
                44829,
                44830,
                44831,
                44832,
                44833,
                44834,
                44835,
                44836,
                44837,
                44838,
                44839,
                44840,
                44841,
                44842,
                44843,
                44844,
                44845,
                44846,
                44847,
                44848,
                44849,
                44850,
                44851,
                44852,
                44853,
                44854,
                44855,
                44856,
                44857,
                44858,
                44859,
                44860,
                44861,
                44862,
                44863,
                44864,
                44865,
                44866,
                44867,
                44868,
                44869,
                44870,
                44871,
                44872,
                44873,
                44874,
                44875,
                44876,
                44877,
                44878,
                44879,
                44880,
                44881,
                44882,
                44883,
                44884,
                44885,
                44886,
                44887,
                44888,
                44889,
                44890,
                44891,
                44892,
                44893,
                44894,
                44895,
                44896,
                44897,
                44898,
                44899,
                44900,
                44901,
                44902,
                44903,
                44904,
                44905,
                44906,
                44907,
                44908,
                44909,
                44910,
                44911,
                44912,
                44913,
                44914,
                44915,
                44916,
                44917,
                44918,
                44919,
                44920,
                44921,
                44922,
                44923,
                44924,
                44925,
                44926,
                44927,
                44928,
                44929,
                44930,
                44931,
                44932,
                44933,
                44934,
                44935,
                44936,
                44937,
                44938,
                44939,
                44940,
                44941,
                44942,
                44943,
                44944,
                44945,
                44946,
                44947,
                44948,
                44949,
                44950,
                44951,
                44952,
                44953,
                44954,
                44955,
                44956,
                44957,
                44958,
                44959,
                44960,
                44961,
                44962,
                44963,
                44964,
                44965,
                44966,
                44967,
                44968,
                44969,
                44970,
                44971,
                44972,
                44973,
                44974,
                44975,
                44976,
                44977,
                44978,
                44979,
                44980,
                44981,
                44982,
                44983,
                44984,
                44985,
                44986,
                44987,
                44988,
                44989,
                44990,
                44991,
                44992,
                44993,
                44994,
                44995,
                44996,
                44997,
                44998,
                44999,
                45000,
                45001,
                45002,
                45003,
                45004,
                45005,
                45006,
                45007,
                45008,
                45009,
                45010,
                45011,
                45012,
                45013,
                45014,
                45015,
                45016,
                45017,
                45018,
                45019,
                45020,
                45021,
                45022,
                45023,
                45024,
                45025,
                45026,
                45027,
                45028,
                45029,
                45030,
                45031,
                45032,
                45033,
                45034,
                45035,
                45036,
                45037,
                45038,
                45039,
                45040,
                45041,
                45042,
                45043,
                45044,
                45045,
                45046,
                45047,
                45048,
                45049,
                45050,
                45051,
                45052,
                45053,
                45054,
                45055,
                45056,
                45057,
                45058,
                45059,
                45060,
                45061,
                45062,
                45063,
                45064,
                45065,
                45066,
                45067,
                45068,
                45069,
                45070,
                45071,
                45072,
                45073,
                45074,
                45075,
                45076,
                45077,
                45078,
                45079,
                45080,
                45081,
                45082,
                45083,
                45084,
                45085,
                45086,
                45087,
                45088,
                45089,
                45090,
                45091,
                45092,
                45093,
                45094,
                45095,
                45096,
                45097,
                45098,
                45099,
                45100,
                45101,
                45102,
                45103,
                45104,
                45105,
                45106,
                45107,
                45108,
                45109,
                45110,
                45111,
                45112,
                45113,
                45114,
                45115,
                45116,
                45117,
                45118,
                45119,
                45120,
                45121,
                45122,
                45123,
                45124,
                45125,
                45126,
                45127,
                45128,
                45129,
                45130,
                45131,
                45132,
                45133,
                45134,
                45135,
                45136,
                45137,
                45138,
                45139,
                45140,
                45141,
                45142,
                45143,
                45144,
                45145,
                45146,
                45147,
                45148,
                45149,
                45150,
                45151,
                45152,
                45153,
                45154,
                45155,
                45156,
                45157,
                45158,
                45159,
                45160,
                45161,
                45162,
                45163,
                45164,
                45165,
                45166,
                45167,
                45168,
                45169,
                45170,
                45171,
                45172,
                45173,
                45174,
                45175,
                45176,
                45177,
                45178,
                45179,
                45180,
                45181,
                45182,
                45183,
                45184,
                45185,
                45186,
                45187,
                45188,
                45189,
                45190,
                45191,
                45192,
                45193,
                45194,
                45195,
                45196,
                45197,
                45198,
                45199,
                45200,
                45201,
                45202,
                45203,
                45204,
                45205,
                45206,
                45207,
                45208,
                45209,
                45210,
                45211,
                45212,
                45213,
                45214,
                45215,
                45216,
                45217,
                45218,
                45219,
                45220,
                45221,
                45222,
                45223,
                45224,
                45225,
                45226,
                45227,
                45228,
                45229,
                45230,
                45231,
                45232,
                45233,
                45234,
                45235,
                45236,
                45237,
                45238,
                45239,
                45240,
                45241,
                45242,
                45243,
                45244,
                45245,
                45246,
                45247,
                45248,
                45249,
                45250,
                45251,
                45252,
                45253,
                45254,
                45255,
                45256,
                45257,
                45258,
                45259,
                45260,
                45261,
                45262,
                45263,
                45264,
                45265,
                45266,
                45267,
                45268,
                45269,
                45270,
                45271
            ],
            "noteBarriers": [
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32,
                7320.32
            ],
            "optionBarriers": [
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24,
                5490.24
            ],
            "putStrike": 7320.32,
            "nominal": 28000000,
            "couponRate": 0.14,
            "gearing": 3824.9694,
            "guaranteedRate": 0,
            "promiseRate": 0,
            "hitOptionBarrier": True,
            "dayCounter": "Act365"
        },
        "autocallEngineMaker": {
            "engineType": "QuadSnowBallOptionEngineMaker",
            "n": 701,
            "parallel": True
        },
        "generalizedBlackScholesProcessMaker": {
            "processType": "ConstParam",
            "x0": 6140.83,
            "dividendRate": 0.13,
            "riskFreeRate": 0.05,
            "sigma": 0.16,
            "dayCounter": "Act365"
        }
    }

    url = "http://127.0.0.1:50050/api/pricing"
    # calculate time in milliseconds while calling restful api 1000 times in 5 threads
    start = time.time()
    threads = []
    for i in range(5):
        t = threading.Thread(target=call_api, args=(url, autocall,))
        threads.append(t)
        t.start()
    for t in threads:
        t.join()
    end = time.time()
    print("time cost: ", end - start)
